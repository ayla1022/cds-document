### 查询监听策略列表

#### 1.接口描述

**Action:** DescribeLoadBalancerStrategys

**描述:** 获取Ha实例的当前监听的策略配置列表

**请求地址:** cdsapi.capitalonline.net/lb

**请求方法:** GET

#### 2.请求参数

| 参数名       | 必选 | 类型   | 说明     |
| ------------ | ---- | ------ | -------- |
| InstanceUuid | 是   | string | 实例编号 |

#### 3.请求示例

```python
def get_strategy_list(instance_uuid):
    """
    获取单个实例所有的策略配置
    """
    action = "DescribeLoadBalancerStrategys"
    method = "GET"
    param = {
        "InstanceUuid": instance_uuid
    }
    url = get_signature(action, AK, AccessKeySecret, method, HAPROXY_URL, param)
    res = requests.get(url)
    result = json.loads(res.content)
    print(result)
```

#### 4.返回参数

| 参数名             | 类型   | 说明                                                         |
| ------------------ | ------ | ------------------------------------------------------------ |
| Code               | string | 状态码                                                       |
| Data               | dict   | 数据                                                         |
| Message            | string | 信息描述                                                     |
| TaskId             | string | 任务编号                                                     |
| HttpListeners      | list   | http 监听策略配置列表                                        |
| TcpListeners       | list   | tcp 的监听策略列表                                           |
| EnableSourceIp     | string | 是否开启获取源IP 【"on","off"】                              |
| EnableRepeaterMode | string | 是否当前Haproxy为中继默认且支持源IP透传 【"on","off"】       |
| ServerTimeoutUnit  | string | 设置服务端超时时间单位 【"ms","s"】                          |
| ServerTimeout      | string | 设置服务端超时时间                                           |
| StickySession      | string | 是否开启回话保持 【"on","off"】                              |
| AclWhiteList       | list   | 设置白名单，例如【"129.12.12.1"，"192.168.1.1/20"】          |
| CertificateIds     | list   | http 监听可以绑定证书，不绑定传空列表                        |
| CertificateId      | list   | 证书编号                                                     |
| CertificateName    | list   | 证书名称                                                     |
| ListenerMode       | string | 监听模式                                                     |
| maxConn            | int    | 代理端的最大连接数                                           |
| ClientTimeoutUnit  | string | 设置请求连接超时的时间单位【"ms","s"】                       |
| Scheduler          | string | 调度算法【"roundrobin", "leastconn", "static-rr", "source"】 |
| BackendServer      | list   | 后端服务器配置                                               |
| IP                 | string | 后端服务器Ip地址                                             |
| Port               | string | 后端服务器端口                                               |
| Weight             | string | 后端服务器权重                                               |
| MaxConn            | int    | 后端服务器最大连接数                                         |
| ConnectTimeout     | int    | 设置请求连接超时时间                                         |
| ClientTimeout      | string | 设置客户端连接超时的时间                                     |
| ListenerName       | string | 监听策略的名称，用于生成配置文件，名称不能相同               |
| ClientTimeoutUnit  | int    | 设置客户端连接超时的时间单位【"ms","s"】                     |
| ListenerPort       | int    | Ha最为代理配置的端口                                         |

#### 5.返回示例

```python
{
    "Code": "Success",
    "Data": {
        "HttpListeners": [{
            "AclWhiteList": ["192.168.1.1"],
            "BackendServer": [{
                "IP": "66.66.0.8",
                "MaxConn": 2000,
                "Port": 323,
                "Weight": "1"
            }],
            "CertificateIds": [{
                "CertificateId": "101783f7-8188-4f89-9f0d-2c441d2f3fbb",
                "CertificateName": "证书gi8Zs29U"
            }],
            "ClientTimeout": "222",
            "ClientTimeoutUnit": "s",
            "ConnectTimeout": "111",
            "ConnectTimeoutUnit": "ms",
            "ListenerMode": "http",
            "ListenerName": "http43",
            "ListenerPort": 0,
            "MaxConn": 50000,
            "Scheduler": "roundrobin",
            "ServerTimeout": "333",
            "ServerTimeoutUnit": "ms",
            "StickySession": "off"
        }],
        "TcpListeners": [{
            "AclWhiteList": ["192.168.1.1"],
            "BackendServer": [{
                "IP": "164.52.35.242",
                "MaxConn": 2000,
                "Port": 909,
                "Weight": "1"
            }],
            "ClientTimeout": "666",
            "ClientTimeoutUnit": "ms",
            "ConnectTimeout": "555",
            "ConnectTimeoutUnit": "ms",
            "EnableRepeaterMode":"off",
            "EnableSourceIp":"off",
            "ListenerMode": "tcp",
            "ListenerName": "tcp",
            "ListenerPort": 909,
            "MaxConn": 233,
            "Scheduler": "leastconn",
            "ServerTimeout": "777",
            "ServerTimeoutUnit": "ms"
        }]
    },
    "Message": "Success.",
    "TaskId": ""
}
```

