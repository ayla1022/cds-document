---
title: 创建负载均衡HaProxy实例   
date: 2021-12-29 14:24:00
permalink: /pages/1233034/
article: true
---

## 1.接口描述

**Action**： CreateLoadBalancer

**描述**： 创建HaProxy实例

**请求地址**： cdsapi.capitalonline.net/lb

**请求方法**： POST

## 2.请求参数

| 参数名       | 必选 | 类型   | 说明                                                         |
| :----------- | :--- | :----- | :----------------------------------------------------------- |
| RegionId     | 是   | string | 站点编号                                                     |
| VdcId        | 是   | string | 数据中心的编号                                               |
| BasePipeId   | 是   | string | 数据中心的私网编号，创建服务将按这个私网分配id               |
| InstanceName | 是   | string | 实例名称                                                     |
| PaasGoodsId  | 是   | int    | 产品的规格编号                                               |
| Ips          | 是   | list   | ha使用的网络，根据所传不通网络，创建不同网络机器             |
| IsVip        | 否   | int    | 是否开启内网，此参数只适用于公网SLB，内网SLB无需配置，默认值 : 1 1: 表示开启内网Vip 0:表示不开启内网VIp |
| PipeType     | 是   | list   | ha使用的网络 ["pipe_type","public"]                          |
| PipeId       | 是   | string | 内网网络id，或者公网的网络id                                 |
| SegmentId    | 是   | string | 占用的公网网段的编号，会占用3个公网                          |
| Amount       | 否   | int    | 购买的数量一次最多购买三个                                   |

## 3.请求示例

```python
def create_haproxy():
    """
    创建haproxy实例
    """
    action = "CreateLoadBalancer"
    method = "POST"
    param = {}
    url = get_signature(action, AK, AccessKeySecret, method, HAPROXY_URL, param=param)
    body = {
        "RegionId": "******",
        "VdcId": "******",
        "BasePipeId": "******",
        "InstanceName": "test-haproxy",
        "PaasGoodsId": "5072",
        "Ips": [
            {
                "PipeType": "private",
                "PipeId": "******",
                "IsVip": 1},
            {
                "PipeType": "public",  # 如创建公网，则需要
                "PipeId": "******",
                "SegmentId": "******"
            }
        ],
        "Amount": 1
    }

    res = requests.post(url, json=body)
    result = json.loads(res.content)
```

## 4.返回参数

| 参数名        | 类型   | 说明                       |
| :------------ | :----- | :------------------------- |
| Message       | string | 信息描述                   |
| Code          | string | 状态码                     |
| Data          | dict   | 包含任务编码和实例编码列表 |
| InstancesUuid | list   | 实例编码                   |
| TaskId        | string | 任务id                     |

## 5.返回示例

```python
{
    "Message": "Success.",
    "Code": "Success",
    "Data": {
        "InstancesUuid":["5d74bb81-0473-464d-b15b-0ae418619248",]
    },
    "TaskId": "********"
}
```

