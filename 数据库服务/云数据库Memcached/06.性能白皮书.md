---
title: 性能白皮书
date: 2022-04-06 16:06:16
permalink: /pages/17129018/
article: true
---



对云数据库Memcached实例的性能评估，比如测试某种实例规格的set或get在某个高并发场景下的性能，可参考本文的测试方法。

> 本文使用memtier_benchmark 工具进行性能评估

​        memtier_benchmark是Redis Labs推出的一款命令行工具，它能够产生各种各样的流量模式，可以对Memcached和Redis实例进行基准测试。
这个工具提供了丰富的自定义选项和报表功能，通过命令行界面就能够轻松地使用。

了解memtier_benchmark更多详情，请访问https://github.com/RedisLabs/memtier_benchmark。



### memtier_benchmark安装

##### 测试工具

​         memtier_benchmark是Redis Labs推出的一款命令行工具，它能够产生各种各样的流量模式，可以对Memcached和Redis实例进行基准测试。
这个工具提供了丰富的自定义选项和报表功能，通过命令行界面就能够轻松地使用。

了解memtier_benchmark更多详情，请访问https://github.com/RedisLabs/memtier_benchmark。

##### 下载与安装

> 以ubuntu20.4系统为例, 配置 os 磁盘: 20G, cpu: 8C, ram:16G

1. 准备工作及安装依赖

   ```shell
   apt update
   apt install build-essential autoconf automake libpcre3-dev libevent-dev pkg-config zlib1g-dev libssl-dev git -y
   ```

2. 下载并编译安装

   ```shell
   git clone https://github.com/RedisLabs/memtier_benchmark.git
   cd memtier_benchmark
   autoreconf -ivf
   ./configure
   make -j 4;make install;
   cd ..
   ```

3. 验证

   ```shell
   memtier_benchmark --help
   ```

##### 测试步骤

1. 创建memcached实例

2. 创建1台云主机，选择与memcached实例相同的虚拟数据中心，配置相同的网络。

3. 在云主机上安装memtier_benchmark，步骤参考 [安装步骤](#下载与安装)

4. 在云主机上执行memtier_benchmark命令

   ```shell
   memtier_benchmark -s 10.241.14.13 -p 11211 -P memcache_text -d 32 --show-config -t 8 -c 100 --test-time=180 --out-file=memcached-1g
   ```

   参数说明：

   - -s  memcached服务的ip地址
   - -p memcached服务的端口
   - -P memcached的协议，本例使用的是memcache_text
   - -d 表示单条数据大小，单位byte
   - -t 表示基准测试使用的线程数量
   - -c 表示客户端连接数
   - --test-time 表示基准测试测试时长，单位 ：秒
   - --show-config 运行基准测试之前，输出详细的配置信息
   - --out-file 输出结果文件的名称



### 性能样本

| 规格 | 运行memtier_benchmark个数 | 线程数量 | 连接数 | 测试时长(s) | 平均OPS | 测试样本文件连接 |
| ---- | ------------------------- | -------- | ------ | ----------- | ------- | ---------------- |
| 1G   | 1                         | 8        | 100    | 180         | 18w     |                  |
| 2G   | 1                         | 8        | 100    | 180         | 18w     |                  |
| 4G   | 1                         | 8        | 100    | 180         | 29w     |                  |
| 8G   | 1                         | 8        | 100    | 180         | 28w     |                  |
| 16G  | 1                         | 8        | 100    | 180         | 30w     |                  |
| 24G  | 1                         | 8        | 100    | 180         | 31w     |                  |
| 32G  | 1                         | 8        | 100    | 180         | 29w     |                  |
| 64G  | 1                         | 8        | 100    | 180         | 46w     |                  |
| 128G | 1                         | 8        | 100    | 180         | 61w     |                  |

