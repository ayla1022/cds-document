---
title: 使用直连地址连接
date: 2021-12-31 17:02:02
permalink: /pages/477061/
article: true
---

开通直连访问后，您可以绕过代理，用直连模式访问云数据库Redis集群版实例。

## 前提条件

- 成功购买Redis社区集群版实例，实例状态为运行中。购买Redis实例，详情参见[创建实例](./../../04.快速入门/00.创建Redis实例.md)。
- 已配置云服务器与Redis的网络连接规则，并[设置白名单](./../../04.快速入门/01.设置白名单.md)来限制访问Redis实例的IP。如果您允许同一私网网段的所有云服务器皆可访问Redis实例，可以跳过此步骤。
- 您已开通直连访问，开通步骤详情参见[设置直连访问](./../../05.操作指南/02.管理实例/01.设置直连访问.md)。

## 使用直连地址连接

> 注意：
>
> - 使用直连地址访问时，必须使用直连密码认证连接。

### Jedis客户端直连示例

```java
 import java.util.HashSet;
 import java.util.Set;
 import redis.clients.jedis.HostAndPort;
 import redis.clients.jedis.JedisCluster;

   public class TestJedisCluster {

public static void main(String[] args) {
    //创建JedisCluster客户端
    //创建一个set集合，用来封装所有redis节点的信息
    Set<HostAndPort> nodes = new HashSet<>();
    
    nodes.add(new HostAndPort("10.XX.XX.12", 6379));
    nodes.add(new HostAndPort("10.XX.XX.13", 6379));
    nodes.add(new HostAndPort("10.XX.XX.14", 6379));
    nodes.add(new HostAndPort("10.XX.XX.15", 6379));
    nodes.add(new HostAndPort("10.XX.XX.16", 6379));
    nodes.add(new HostAndPort("10.XX.XX.17", 6379));
    nodes.add(new HostAndPort("10.XX.XX.18", 6379));
    nodes.add(new HostAndPort("10.XX.XX.19", 6379));  
    JedisCluster cluster = new JedisCluster(nodes);
    //执行JedisCluster对象中的方法，方法和redis一一对应。
    cluster.set("cluster-test", "my jedis cluster test");
    String result = cluster.get("cluster-test");
    System.out.println(result);
    //程序结束时需要关闭JedisCluster对象
    cluster.close();
    }
}
```

### redis-py客户端直连示例

```python
#!/usr/bin/python
# -*- coding: utf-8 -*-


import pprint
from time import ctime,sleep
from rediscluster import RedisCluster

startup_nodes = [
    {"host":"10.XX.XX.12", "port":6379},
    {"host":"10.XX.XX.13", "port":6379},
    {"host":"10.XX.XX.14", "port":6379},
    ... ...
    {"host":"10.XX.XX.19", "port":6379},
]
redis_conn= RedisCluster(startup_nodes=startup_nodes, password="XXXXXXXXXXXXXXX",skip_full_coverage_check=True,decode_responses=True)
nodes = redis_conn.cluster_nodes()
# pprint.pprint(nodes)
for row in nodes:
    print row

for i in range(0, 100):
    try:
        redis_conn.set('name'+str(i),str(i))
    except:
        print("connect to redis cluster error")
        #time.sleep(2)
```

## 常见问题

[如何获取直连地址？](./../../05.操作指南/02.管理实例/01.设置直连访问.md)

