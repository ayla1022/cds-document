### 备份数据库

数据备份用于数据损坏或丢失，您可以设置备份策略自动备份或手动备份，备份的方式为物理备份。

#### 备份简介

##### 备份方式

云数据库 MySQL 主从版支持**自动备份**和**手动备份**两种方式来备份数据库。

##### 备份类型

云数据库 MySQL 目前只支持**物理备份**，物理数据全拷贝（自动备份与手动备份均支持）。

#### 注意事项：

- 物理备份属于热备份，服务实例不需要停机，对您的线上业务没有影响。
- 备份期间不要执行DDL操作，避免锁表导致备份失败。
- 请尽量选择业务低峰期进行备份。
- 若数据量较大，花费的时间可能较长，请耐心等待。
- 实例的备份文件将上传至对象存储，对象存储提供实例存储空间大小的免费额度，超出免费额度的备份会进行收费，详情参见[备份空间收费说明](http://wiki-private.capitalonline.net:8090/pages/viewpage.action?pageId=75826697)。

#### 自动备份

1.登录数据库服务页面，点击实例的名称进入到实例管理页面，点击【备份恢复】，或从更多操作中选择【备份恢复】进入。

2.在“备份恢复”页面点击【自动备份设置】，查看目前备份策略。

![img](http://wiki-private.capitalonline.net:8090/download/attachments/83132674/image2021-4-21_10-36-8.png?version=1&modificationDate=1624327069000&api=v2)

3.点击【编辑】，对备份策略进行配置。

![img](http://wiki-private.capitalonline.net:8090/download/attachments/83132674/image2021-6-23_9-40-49.png?version=1&modificationDate=1624412447000&api=v2)

4.在备份设置页面设置自动备份策略，参数说明如下:

| 参数             | 说明                                                         |
| :--------------- | :----------------------------------------------------------- |
| 备份周期         | 可以设置为一星期中的某一天或某几天。                         |
| 备份时间         | 可设置为一天中的任意整点时段，以小时为单位，建议设置为业务低峰期时间。 |
| 备份方式         | 备份方式为物理备份，将会备份整个数据库实例。                 |
| 数据备份保留时长 | 数据备份文件保留的天数，默认为7天                            |
| 开启数据自动备份 | 可以设置数据自动备份是否开启，默认开启                       |
| 日志备份保留时长 | 日志备份文件保留天数，默认为7天                              |
| 保留时长         | 本地binlog文件保留时间，默认72小时                           |
| 最大空间使用率   | 本地binlog文件占用存储空间最大比值，默认30%                  |

5.如果不需要数据自动备份，可以点击“开启数据自动备份”开关。

![img](http://wiki-private.capitalonline.net:8090/download/attachments/83132674/image2021-6-23_9-41-24.png?version=1&modificationDate=1624412483000&api=v2)

#### 手动备份

1.登录数据库服务页面，点击实例的名称进入到实例管理页面，点击【备份恢复】，或从更多操作中选择【备份恢复】进入。

2.在“备份恢复”页面点击【备份实例】。

![img](http://wiki-private.capitalonline.net:8090/download/attachments/83132674/image2021-4-21_10-44-34.png?version=1&modificationDate=1624327069000&api=v2)

3.在弹出的窗口中，配置备份方法和备份保留天数，点击【确认】。（**注意：**备份保留天数跟随自动备份设置的保留天数）

| 参数     | 说明                                     |
| :------- | :--------------------------------------- |
| 备份方法 | 备份方式目前只有物理备份，将备份整个实例 |
| 备注     | 为备份文件输入备注                       |

![img](http://wiki-private.capitalonline.net:8090/download/attachments/83132674/image2021-4-21_10-45-8.png?version=1&modificationDate=1624327070000&api=v2)

#### 常见问题

##### 1.超出备份保留时间的备份还能保留及使用吗？

超出保留时间的备份会被删除，无法继续使用，建议您设置合理备份策略，或使用手动备份，手动备份会一直保存。

##### 2.我可以删除备份吗？

- 自动备份不可手动删除，超出设置的数据保留时长时会自动删除。
- 手动备份可以在数据备份列表中点击【删除】进行删除，如不删除则会一直保留，详情参见[删除备份](http://wiki-private.capitalonline.net:8090/pages/viewpage.action?pageId=77234219)。

##### 3.我可以关闭自动备份吗？

您可以通过编辑备份策略，点击“开启数据自动备份”开关进行关闭数据自动备份操作。

#### 备份保留时长建议

| 业务场景             | 备份保留时长                                                 |
| :------------------- | :----------------------------------------------------------- |
| 核心业务             | 建议7天 - 732天                                              |
| 非核心、非数据类业务 | 建议7天                                                      |
| 归档业务             | 建议数据备份保留时间设置为7天，根据实际业务需求手动备份数据，用完及时删除 |
| 测试业务             | 建议数据备份保留时间设置为7天，根据实际业务需求手动备份数据，用完及时删除 |
