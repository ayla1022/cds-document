---
title: 数据库架构
date: 2022-08-26 17:00:00
permalink: /pages/746005/
article: true
---


#### 副本集

云数据库 MongoDB 副本集采用三节点架构实现高可用，副本集实例由一个 Primary 节点、一个 Secondary 节点和一个 hidden 节点组成。

- Primary 节点：MongoDB 主节点，负责处理客户端的读写请求。每个副本集架构实例中只能有一个 Primary 节点。
- Secondary 节点：MongoDB 从节点，通过操作日志（oplog）同步主节点的数据。当主节点故障时，从节点可提升为新主节点，实现高可用。
- Hidden 节点：MongoDB隐藏节点，通过操作日志（oplog）同步从节点的数据。只用于备份，不处理客户端的读写请求。

![framework_replica](./../pic/framework_replica.png)

#### 分片集

云数据库 MongoDB 分片集在副本集架构之上，通过多组复制集群组合，实现集群的横向扩展。每一个分片集实例由 mongos 节点、Config Server节点 和 Shard 分片组成。分片集实例支持用户自行配置Mongos节点和Shard分片的个数。

- Mongos 节点：负责接收所有客户端的连接请求，将请求路由到集群内部对应的Shard上，同时会把接收到的响应拼装起来返回给客户端，支持创建多个 Mongos 节点实现负载均衡及故障迁移。单个分片集实例支持创建2-16个Mongos节点。
- Shard 分片：负责将数据分片存储在多个服务器上，支持创建多个Shard分片来横向扩展实例的数据存储能力和读写并发能力。单个分片集实例支持 2-16个Shard 分片。
- Config Server 节点：负责存储集群和 Shard 节点的元数据信息，如集群的节点信息、分片数据的路由信息等。ConfigServer 节点规格固定为 1C2G，磁盘空间为 60GB，默认3个节点，不可变更配置。

![framework_shard](./../pic/framework_shard.png)
