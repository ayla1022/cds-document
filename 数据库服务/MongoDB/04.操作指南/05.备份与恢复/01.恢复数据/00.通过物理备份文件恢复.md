---
title: 数据恢复
date: 2022-09-22 17:00:00
permalink: /pages/746021/
article: true
---


## 操作场景

云数据库MongoDB支持基于物理备份文件恢复实例，通过将备份数据恢复到临时实例，再将临时实例转正的方式创建一个新实例，新实例种的数据与备份文件一致，可用于数据恢复或快速部署业务等场景。

## 前置条件

MongoDB实例已完成物理备份，备份操作详情参见[自动物理备份](./../../../04.操作指南/05.备份与恢复/00.备份数据/00.自动备份.md)或[手动物理备份](./../../../04.操作指南/05.备份与恢复/00.备份数据/01.手动备份.md#物理备份)。

## 操作步骤



> **注意**：
>
> - 回档功能与自动备份设置的备份周期时间和保留天数相关联，备份周期设置详情请参见 [备份数据库](./00.备份数据库.md)。
> - 为保证数据安全，自动备份设置的备份周期请设置为一周至少备份两次 MongoDB。 例如：您设置的备份周期为周一、周四，备份保留天数为7天，则可选回档至保留天数内的任意一天。
> - 实例的 oplog 空间为固定集合（Capped Collection），当集合空间用完后，再插入的元素就会覆盖最先插入的元素。

## 操作步骤

1. 进入 [云数据库 MongoDB 控制台](https://console.capitalonline.net/mongodb)，点击数据库服务列表页操作 **详情** 按钮进入实例管理页面，点击 **备份** 查看备份列表。

2. 点击 **选择时间恢复** 按钮，弹出备份恢复配置窗口。

   ![recovery_console](./../../pic/recovery_console.png)

3. 在选择时间点备份恢复窗口设置回档时间后，点击 **确定** 即可开始数据恢复。

   ![recovery_popup](./../../pic/recovery_popup.png)
   
4. 返回实例列表页，单击实例名称前面的按钮可以展开查看临时实例的状态。

   ![recovery_list](./../../pic/recovery_list.png)

   > **注意**：
   >
   > 临时实例为免费实例，用于存放恢复的数据，临时实例的用户名和密码与原实例一致。原实例保持不变，不会对业务造成影响。

5. 临时实例创建完成后，你可以进行以下操作：

   - **转正**：将临时实例转为独立于原实例的正式实例，供业务使用，按原实例收费标准收费。
   - **删除**：删除该临时实例。

   > **注意**：
   >
   > - 每个实例至多回档到 1 个临时实例。
   > - 未转正的临时实例超过 48 小时自动删除。
